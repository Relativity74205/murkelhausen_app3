{% if error %}
    <div class="alert alert-danger" role="alert">
        <h4 class="alert-heading">Fehler beim Laden der Daten</h4>
        <p>{{ error }}</p>
    </div>
{% else %}
    {% if grouped_appointments %}
        {% for date, appointments in grouped_appointments %}
            <!-- Date Header -->
            <div class="date-header">
                <h4 class="mb-0">{{ date|date:"l, d. F Y" }}</h4>
            </div>

            <!-- Appointments for this date -->
            <div class="row g-3 mb-4">
                {% for appointment in appointments %}
                    <div class="col-12">
                        <div class="card appointment-card shadow-sm">
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <!-- Time Column -->
                                    <div class="col-md-2">
                                        <div class="text-center">
                                            {% if appointment.is_whole_day %}
                                                <span class="badge badge-whole-day">Ganzt√§gig</span>
                                            {% else %}
                                                <div class="fw-bold fs-5">{{ appointment.start_time }}</div>
                                                {% if appointment.start_time != appointment.end_time %}
                                                    <small class="text-muted">bis {{ appointment.end_time }}</small>
                                                {% endif %}
                                            {% endif %}
                                        </div>
                                    </div>

                                    <!-- Event Details Column -->
                                    <div class="col-md-7">
                                        <h5 class="mb-2">{{ appointment.event_name }}</h5>
                                        <div>
                                            <!-- Work Calendar Badge -->
                                            <span class="badge badge-work">Arbeit</span>

                                            <!-- Recurring Badge -->
                                            {% if appointment.is_recurring %}
                                                <span class="badge badge-recurring">üîÑ Wiederkehrend</span>
                                            {% endif %}

                                            <!-- Tentative Badge -->
                                            {% if appointment.is_tentative %}
                                                <span class="badge bg-warning text-dark">‚ö†Ô∏è Unter Vorbehalt</span>
                                            {% endif %}

                                            <!-- Location -->
                                            {% if appointment.location %}
                                                <div class="mt-2">
                                                    <small class="text-muted">
                                                        üìç {{ appointment.location }}
                                                    </small>
                                                </div>
                                            {% endif %}

                                            <!-- Description -->
                                            {% if appointment.description %}
                                                <div class="mt-2">
                                                    <small class="text-muted">
                                                        {{ appointment.description }}
                                                    </small>
                                                </div>
                                            {% endif %}
                                        </div>
                                    </div>

                                    <!-- Duration Info Column -->
                                    <div class="col-md-3">
                                        <div class="text-end">
                                            {% if appointment.start_date != appointment.end_date %}
                                                <small class="text-muted">
                                                    <div>Mehrt√§gig</div>
                                                    <div>{{ appointment.start_date|date:"d.m." }} - {{ appointment.end_date|date:"d.m.Y" }}</div>
                                                </small>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% endfor %}
    {% else %}
        <div class="alert alert-info" role="alert">
            <h4 class="alert-heading">Keine Termine</h4>
            <p>F√ºr den ausgew√§hlten Zeitraum sind keine Arbeitstermine geplant.</p>
        </div>
    {% endif %}
{% endif %}
